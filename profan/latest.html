<!doctype html>
<title>profanOS</title>

<script src="/profan/build/libv86.js"></script>
<link rel="stylesheet" href="/profan/venu.css">
<script>
"use strict";

window.onload = function()
{   
    // get all the files il the release repo
    var api_url = "https://api.github.com/repos/esolangs/profanOS-build/contents/img";
    // get the files in the release repo
    var request = new XMLHttpRequest();
    var liste = document.getElementById("files");
    request.open("GET", api_url, true);
    request.onload = function() {
        if (request.status >= 200 && request.status < 400) {
            var data = JSON.parse(request.responseText);
            var version = data[data.length - 1].name;
            console.log(version);
            var img_url = "https://esolangs.github.io/profanOS-build/img/" + version;
            var emulator = window.emulator = new V86Starter({
                wasm_path: "/profan/build/v86.wasm",
                memory_size: 32 * 1024 * 1024,
                vga_memory_size: 2 * 1024 * 1024,
                screen_container: document.getElementById("screen_container"),
                bios: {
                    url: "/profan/bios/seabios.bin",
                },
                vga_bios: {
                    url: "/profan/bios/vgabios.bin",
                },
                fda: {
                    url: img_url,
                },
                hda: {
                    url: "/profan/img/HDD.bin",
                },
                autostart: true,
            });
        }
    }
    request.send();
}
</script>

<!-- A minimal structure for the ScreenAdapter defined in browser/screen.js -->
<div id="screen_container">
    <div class = "shell"></div>
    <canvas style="display: none"></canvas>
</div>
